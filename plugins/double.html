
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>Mongoose Plugins Search</title>
    <link rel="stylesheet" href="/public/style.css">

    <script type="text/javascript">
      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
      xhr.setRequestHeader('Content-Type', 'application/json');
      xhr.onreadystatechange = function() {};
      xhr.send(JSON.stringify({
        path: window.location.pathname,
        hostname: window.location.hostname,
        hash: window.location.hash
      }));
    </script>
  </head>
  <body>
    <div id="wrap">
      
    <script type="text/javascript" src="/public/native.js"></script>
    <link rel="stylesheet" href="/public/inlinecpc.css">
    <link rel="stylesheet" href="/public/highlight.css">
    <link rel="stylesheet" href="/public/plugin.css">
    <style>
      a, a:visited {
        color: #0366d6;
      }
    </style>

    <script>
      _native.init("CK7DT53Y",{
        targetClass: 'native-inline'
      });
    </script>

    <div class="content">
      <div class="toc desktop">
        <h2><a href="/">Mongoose Plugins</a></h2>
        <div>
          <div id="select-plugin"><a class="select-plugin-this-repo" href="./double">mongoose-double</a> <span class="right-arrow"></span><div id="select-plugin-hidden"><a href="./autopopulate">mongoose-autopopulate</a>
<a href="./lean-virtuals">mongoose-lean-virtuals</a>
<a href="./int32">mongoose-int32</a>
<a href="./update-versioning">mongoose-update-versioning</a>
<a href="./lean-getters">mongoose-lean-getters</a></div></div>
        </div>
        <ul>
<li><a href="#importing">Importing</a></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#it-ensures-your-numbers-are-always-stored-as-doubles-in-mongodb">It ensures your numbers are always stored as doubles in MongoDB</a></li>
<li><a href="#it-bypasses-the-mongodb-drivers-integer-coercion">It bypasses the MongoDB driver&#39;s integer coercion</a></li>
</ul>
</li>
<li><a href="#changelog">Changelog</a><ul>
<li><a href="#012--2018-10-16">0.1.2 / 2018-10-16</a></li>
<li><a href="#011--2018-05-07">0.1.1 / 2018-05-07</a></li>
<li><a href="#010--2018-05-01">0.1.0 / 2018-05-01</a></li>
<li><a href="#001--2012-11-16">0.0.1 / 2012-11-16</a></li>
</ul>
</li>
</ul>

        <div id="carbonads-wrapper">
          <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CK7DT537&placement=mongoosejsio" id="_carbonads_js"></script>
        </div>
      </div>
      <h1 id="repo" class="desktop">mongoose-double</h1>
      <div class="toc mobile">
        <h2><a href="/">Mongoose Plugins</a></h2>
        <div>
          <select id="select-plugin-mobile" onchange="window.location.href = '/plugins/' + this.value">
      <option value="autopopulate" >
        mongoose-autopopulate
      </option>
    

      <option value="lean-virtuals" >
        mongoose-lean-virtuals
      </option>
    

      <option value="int32" >
        mongoose-int32
      </option>
    

      <option value="double" selected>
        mongoose-double
      </option>
    

      <option value="update-versioning" >
        mongoose-update-versioning
      </option>
    

      <option value="lean-getters" >
        mongoose-lean-getters
      </option>
    </select>
        </div>
        <ul>
<li><a href="#importing">Importing</a></li>
<li><a href="#examples">Examples</a><ul>
<li><a href="#it-ensures-your-numbers-are-always-stored-as-doubles-in-mongodb">It ensures your numbers are always stored as doubles in MongoDB</a></li>
<li><a href="#it-bypasses-the-mongodb-drivers-integer-coercion">It bypasses the MongoDB driver&#39;s integer coercion</a></li>
</ul>
</li>
<li><a href="#changelog">Changelog</a><ul>
<li><a href="#012--2018-10-16">0.1.2 / 2018-10-16</a></li>
<li><a href="#011--2018-05-07">0.1.1 / 2018-05-07</a></li>
<li><a href="#010--2018-05-01">0.1.0 / 2018-05-01</a></li>
<li><a href="#001--2012-11-16">0.0.1 / 2012-11-16</a></li>
</ul>
</li>
</ul>

      </div>
      <div class="native-inline">
        <a href="#native_link#"><span class="sponsor">Sponsor</span> #native_company# â€” #native_desc#</a>
      </div>
      <h1 id="importing">Importing</h1>
<pre><code class="language-javascript"><span class="hljs-comment">// Using Node.js `require()`</span>
<span class="hljs-keyword">const</span> Double = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@mongoosejs/double'</span>);

<span class="hljs-comment">// Using ES6 imports</span>
<span class="hljs-keyword">import</span> Double <span class="hljs-keyword">from</span> <span class="hljs-string">'@mongoosejs/double'</span>;</code></pre>


      

<h1 id="examples">Examples</h1>


<h2 id="it-ensures-your-numbers-are-always-stored-as-doubles-in-mongodb">It ensures your numbers are always stored as doubles in MongoDB</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> mongoose.Schema({ <span class="hljs-attr">val</span>: Double });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Double'</span>, schema);

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> Model({ <span class="hljs-attr">val</span>: <span class="hljs-number">41</span> });

<span class="hljs-comment">// `doc.val` will be an object, not a number, but you can still use it as</span>
<span class="hljs-comment">// a number</span>
assert.ok(doc.val <span class="hljs-keyword">instanceof</span> mongoose.Types.Double);
assert.ok(doc.val <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Number</span>);
assert.equal(<span class="hljs-keyword">typeof</span> doc.val, <span class="hljs-string">'object'</span>);

++doc.val;

<span class="hljs-keyword">return</span> doc.save().
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Model.findOne({ <span class="hljs-attr">val</span>: { <span class="hljs-attr">$type</span>: <span class="hljs-string">'double'</span> } });
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
    assert.ok(doc);
    assert.equal(doc.val, <span class="hljs-number">42</span>);
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Model.findOne({ <span class="hljs-attr">val</span>: { <span class="hljs-attr">$type</span>: <span class="hljs-string">'int'</span> } });
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
    assert.ok(!doc);
  });</code></pre>


<h2 id="it-bypasses-the-mongodb-drivers-integer-coercion">It bypasses the MongoDB driver&#39;s integer coercion</h2>
<p>This plugin is useful because the <a href="https://www.npmjs.com/package/mongodb">MongoDB Node.js driver</a>
will store the JavaScript number <code>5.01</code> as a double, but it will store <code>5</code>
as an integer. There is currently no option to opt out of this behavior
in the MongoDB driver.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> mongoose.Schema({ <span class="hljs-attr">val</span>: <span class="hljs-built_in">Number</span> });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Number'</span>, schema);

<span class="hljs-keyword">return</span> Model.create([{ <span class="hljs-attr">val</span>: <span class="hljs-number">5.01</span> }, { <span class="hljs-attr">val</span>: <span class="hljs-number">5</span> }]).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Model.findOne({ <span class="hljs-attr">val</span>: { <span class="hljs-attr">$type</span>: <span class="hljs-string">'double'</span> } });
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
    assert.ok(doc);
    assert.equal(doc.val, <span class="hljs-number">5.01</span>);
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> Model.findOne({ <span class="hljs-attr">val</span>: { <span class="hljs-attr">$type</span>: <span class="hljs-string">'int'</span> } });
  }).
  then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">doc</span>) </span>{
    assert.ok(doc);
    assert.equal(doc.val, <span class="hljs-number">5</span>);
  });</code></pre>


      <h1 id="changelog">Changelog</h1>
<h2 id="012--2018-10-16">0.1.2 / 2018-10-16</h2>
<ul>
<li>chore: add homepage to npm</li>
<li>docs: add examples.md</li>
</ul>
<h2 id="011--2018-05-07">0.1.1 / 2018-05-07</h2>
<ul>
<li>docs: clean up example code formatting</li>
</ul>
<h2 id="010--2018-05-01">0.1.0 / 2018-05-01</h2>
<ul>
<li>feat: add mongoose 5 support, re: Automattic/mongoose#5813</li>
</ul>
<h2 id="001--2012-11-16">0.0.1 / 2012-11-16</h2>
<ul>
<li>initial release</li>
</ul>

    </div>
  
    </div>
  </body>
</html>
